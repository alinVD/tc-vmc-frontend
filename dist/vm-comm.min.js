(function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports.vmc=t():e.vmc=t()})(this,function(){var t=Math.LN2,n=Math.log,r=Math.abs,e=Math.min,o=Math.pow,a=Math.floor,s=String.fromCharCode;return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(n,'a',n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=22)}([function(e,t,n){function r(e){return a(this).alloc(e)}function o(e){var t=3*e.length,n=r.call(this,t),o=b.write.call(n,e);return t!==o&&(n=b.slice.call(n,0,o)),n}function a(e){return c(e)?h:u(e)?g:d(e)?y:l?h:p?g:y}function i(){return!1}function s(e,t){return e='[object '+e+']',function(n){return null!=n&&{}.toString.call(t?n[t]:n)===e}}var f=t.global=n(28),l=t.hasBuffer=f&&!!f.isBuffer,p=t.hasArrayBuffer='undefined'!=typeof ArrayBuffer,d=t.isArray=n(5);t.isArrayBuffer=p?function(e){return e instanceof ArrayBuffer||m(e)}:i;var c=t.isBuffer=l?f.isBuffer:i,u=t.isView=p?ArrayBuffer.isView||s('ArrayBuffer','buffer'):i;t.alloc=r,t.concat=function(e,n){n||(n=0,Array.prototype.forEach.call(e,function(e){n+=e.length}));var o=this!==t&&this||e[0],a=r.call(o,n),i=0;return Array.prototype.forEach.call(e,function(e){i+=b.copy.call(e,a,i)}),a},t.from=function(e){return'string'==typeof e?o.call(this,e):a(this).from(e)};var y=t.Array=n(33),h=t.Buffer=n(34),g=t.Uint8Array=n(35),b=t.prototype=n(6),m=s('ArrayBuffer')},function(e,t,n){function r(e){return this instanceof r?void(this.options=e,this.init()):new r(e)}function o(e,t){return e&&t?function(){return e.apply(this,arguments),t.apply(this,arguments)}:e||t}function a(e){function t(e,t){return t(e)}return e=e.slice(),function(n){return e.reduce(t,n)}}function i(e){return f(e)?a(e):e}function s(e){return new r(e)}var f=n(5);t.createCodec=s,t.install=function(e){for(var t in e)r.prototype[t]=o(r.prototype[t],e[t])},t.filter=i;var l=n(0);r.prototype.init=function(){var e=this.options;return e&&e.uint8array&&(this.bufferish=l.Uint8Array),this},t.preset=s({preset:!0})},function(e,t){'use strict';function r(e){if(0>e)throw new Error('Cannot generate negative number of random bytes');return new Uint8Array(crypto.getRandomValues(new Uint8Array(e)).buffer)}function o(e,t){let n=btoa(s(...e));return t&&(n=n.replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'')),n}Object.defineProperty(t,'__esModule',{value:!0}),t.randomBytes=r,t.randomString=function(e){return o(r(e),!0)},t.bytesToHex=function(e){return Array.prototype.map.call(e,(e)=>('00'+e.toString(16)).slice(-2)).join('')},t.hexToBytes=function(e){let t=new Uint8Array(e.length/2);for(var n=0,r=e.length;n<r;n+=2)t[n/2]=parseInt(e.substr(n,2),16);return t},t.bytesToBase64=o,t.base64ToBytes=function(e){e=e.replace(/\-/g,'+').replace(/_/g,'/').replace(/=+$/,''),e+='=='.substring(0,3*e.length%4);let t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<n.length;r++)n[r]=t.charCodeAt(r);return n},t.equalBuffers=function(e,t){if(e.length!=t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0==n},t.sha256=function(e){return new Promise((t,n)=>{crypto.subtle.digest({name:'SHA-256'},e.buffer).then((e)=>t(new Uint8Array(e)),()=>n('Unspecified hash error occurred.'))})}},function(e,t,n){function r(e){var t=s.getWriteType(e);return function(e,n){var r=t[typeof n];if(!r)throw new Error('Unsupported type "'+typeof n+'": '+n);r(e,n)}}function o(){var e=this.options;return this.encode=r(e),e&&e.preset&&i.setExtPackers(this),this}var a=n(4).ExtBuffer,i=n(37),s=n(38),f=n(1);f.install({addExtPacker:function(e,t,n){function r(t){return n&&(t=n(t)),new a(t,e)}n=f.filter(n);var o=t.name;if(o&&'Object'!==o){var i=this.extPackers||(this.extPackers={});i[o]=r}else{var s=this.extEncoderList||(this.extEncoderList=[]);s.unshift([t,r])}},getExtPacker:function(t){var n=this.extPackers||(this.extPackers={}),r=t.constructor,o=r&&r.name&&n[r.name];if(o)return o;for(var e,a=this.extEncoderList||(this.extEncoderList=[]),s=a.length,f=0;f<s;f++)if(e=a[f],r===e[0])return e[1]},init:o}),t.preset=o.call(f.preset)},function(e,t,n){function r(e,t){return this instanceof r?void(this.buffer=o.from(e),this.type=t):new r(e,t)}t.ExtBuffer=r;var o=n(0)},function(e){var t={}.toString;e.exports=Array.isArray||function(e){return'[object Array]'==t.call(e)}},function(e,t,n){function r(e,t,n,r){var s=i.isBuffer(this),f=i.isBuffer(e);if(s&&f)return this.copy(e,t,n,r);if(!p&&!s&&!f&&i.isView(this)&&i.isView(e)){var l=n||null!=r?o.call(this,n,r):this;return e.set(l,t),l.length}return a.copy.call(this,e,t,n,r)}function o(e,t){var n=this.slice||!p&&this.subarray;if(n)return n.call(this,e,t);var o=i.alloc.call(this,t-e);return r.call(this,o,0,e,t),o}var a=n(36);t.copy=r,t.slice=o,t.toString=function(){var e=!l&&i.isBuffer(this)?this.toString:a.toString;return e.apply(this,arguments)},t.write=function(e){return function(){var t=this[e]||a[e];return t.apply(this,arguments)}}('write');var i=n(0),s=i.global,l=i.hasBuffer&&'TYPED_ARRAY_SUPPORT'in s,p=l&&!s.TYPED_ARRAY_SUPPORT},function(e,t,n){(function(e){var n,r,o,i;!function(t){function s(e,n,r){function o(e,t,n,r){return this instanceof o?i(this,e,t,n,r):new o(e,t,n,r)}function i(e,t,n,r,o){if(B&&_&&(t instanceof _&&(t=new B(t)),r instanceof _&&(r=new B(r))),!t&&!n&&!r&&!m)return void(e.buffer=u(v,0));if(!d(t,n)){var a=m||Array;o=n,r=t,n=0,t=new a(8)}e.buffer=t,e.offset=n|=0,E==typeof r||('string'==typeof r?s(t,n,r,o||10):d(r,o)?c(t,n,r,o):'number'==typeof o?(R(t,n+k,r),R(t,n+w,o)):0<r?K(t,n,r):0>r?L(t,n,r):c(t,n,v,0))}function s(e,t,n,r){var o=0,i=n.length,s=0,f=0;'-'===n[0]&&o++;for(var l,p=o;o<i&&(l=parseInt(n[o++],r),!!(0<=l));)f=f*r+l,s=s*r+a(f/S),f%=S;p&&(s=~s,f?f=S-f:s++),R(e,t+k,s),R(e,t+w,f)}function x(){var e=this.buffer,t=this.offset,n=T(e,t+k),o=T(e,t+w);return r||(n|=0),n?n*S+o:o}function R(e,t,n){e[t+D]=255&n,n>>=8,e[t+C]=255&n,n>>=8,e[t+I]=255&n,n>>=8,e[t+U]=255&n}function T(e,t){return e[t+U]*P+(e[t+I]<<16)+(e[t+C]<<8)+e[t+D]}var k=n?0:4,w=n?4:0,U=n?0:3,I=n?1:2,C=n?2:1,D=n?3:0,K=n?y:g,L=n?h:b,O=o.prototype,N='is'+e,Y='_'+N;return O.buffer=void 0,O.offset=0,O[Y]=!0,O.toNumber=x,O.toString=function(e){var t=this.buffer,n=this.offset,o=T(t,n+k),i=T(t,n+w),s='',f=!r&&2147483648&o;for(f&&(o=~o,i=S-i),e=e||10;;){var l=o%e*S+i;if(o=a(o/e),i=a(l/e),s=(l%e).toString(e)+s,!o&&!i)break}return f&&(s='-'+s),s},O.toJSON=x,O.toArray=f,A&&(O.toBuffer=l),B&&(O.toArrayBuffer=p),o[N]=function(e){return!!(e&&e[Y])},t[e]=o,o}function f(e){var t=this.buffer,n=this.offset;return m=null,!1!==e&&0===n&&8===t.length&&x(t)?t:u(t,n)}function l(t){var n=this.buffer,r=this.offset;if(m=A,!1!==t&&0===r&&8===n.length&&e.isBuffer(n))return n;var o=new A(8);return c(o,0,n,r),o}function p(e){var t=this.buffer,n=this.offset,r=t.buffer;if(m=B,!1!==e&&0===n&&r instanceof _&&8===r.byteLength)return r;var o=new B(8);return c(o,0,t,n),o.buffer}function d(e,t){var n=e&&e.length;return t|=0,n&&t+8<=n&&'string'!=typeof e[t]}function c(e,t,n,r){t|=0,r|=0;for(var o=0;8>o;o++)e[t++]=255&n[r++]}function u(e,t){return Array.prototype.slice.call(e,t,t+8)}function y(e,t,n){for(var r=t+8;r>t;)e[--r]=255&n,n/=256}function h(e,t,n){var r=t+8;for(n++;r>t;)e[--r]=255^255&-n,n/=256}function g(e,t,n){for(var r=t+8;t<r;)e[t++]=255&n,n/=256}function b(e,t,n){var r=t+8;for(n++;t<r;)e[t++]=255^255&-n,n/=256}var m,E='undefined',A=E!=typeof e&&e,B=E!=typeof Uint8Array&&Uint8Array,_=E!=typeof ArrayBuffer&&ArrayBuffer,v=[0,0,0,0,0,0,0,0],x=Array.isArray||function(e){return!!e&&'[object Array]'==Object.prototype.toString.call(e)},S=4294967296,P=16777216;n=s('Uint64BE',!0,!0),r=s('Int64BE',!0,!1),o=s('Uint64LE',!1,!0),i=s('Int64LE',!1,!1)}('object'==typeof t&&'string'!=typeof t.nodeName?t:this||{})}).call(t,n(13).Buffer)},function(e,t,n){function r(e){var t=f.getReadToken(e);return function(e){var n=s(e),r=t[n];if(!r)throw new Error('Invalid type: '+(n?'0x'+n.toString(16):n));return r(e)}}function o(){var e=this.options;return this.decode=r(e),e&&e.preset&&i.setExtUnpackers(this),this}var a=n(4).ExtBuffer,i=n(40),s=n(19).readUint8,f=n(41),l=n(1);l.install({addExtUnpacker:function(e,t){var n=this.extUnpackers||(this.extUnpackers=[]);n[e]=l.filter(t)},getExtUnpacker:function(e){var t=this.extUnpackers||(this.extUnpackers=[]);return t[e]||function(t){return new a(t,e)}},init:o}),t.preset=o.call(l.preset)},function(e,t,n){'use strict';function r(e,t){return new Promise((n,r)=>{crypto.subtle.importKey('raw',e.buffer,{name:t},!0,['encrypt','decrypt','wrapKey','unwrapKey']).then((t)=>{e.fill(0),n(new i(t))},(e)=>r(`AES import key: CryptoSubtle error (${e}).`))})}Object.defineProperty(t,'__esModule',{value:!0});const o=n(2),a=n(10);t.AES_IV_LENGTH=16,t.genAESKey=function(e,t){return new Promise((n,r)=>{crypto.subtle.generateKey({name:t,length:8*e},!0,['encrypt','decrypt','wrapKey','unwrapKey']).then((e)=>n(new i(e)),(e)=>r(`AES gen key: CryptoSubtle error (${e}).`))})},t.genCompositeAESKey=function(e,t,n){return new Promise((a,i)=>{if(n=n||32,2>e)throw new Error(`Must generate at least 2 sub-keys (given: ${e}).`);let s=[],f=new Uint8Array(n);for(let l,p=0;p<e;p++){l=o.randomBytes(n);for(let e=0;e<n;e++)f[e]^=l[e];s.push(r(l,t))}Promise.all([r(f,t),...s]).then((e)=>{a({key:e[0],subKeys:e.slice(1)})},(e)=>i(`Composite AES key gen: ${e}`))})},t.importAESKey=r;class i{encrypt(e,n){return new Promise((r,i)=>{if(n=n||{},n.iv=n.iv||o.randomBytes(t.AES_IV_LENGTH),n.iv.length!=t.AES_IV_LENGTH)throw new Error(`AES encrypt: bad IV length (expected ${t.AES_IV_LENGTH}, got ${n.iv.length}).`);crypto.subtle.encrypt({name:this.algo,iv:n.iv},this.key,e.buffer).then((t)=>{e.fill(0);let i=new Uint8Array(t),s={cipherText:o.bytesToBase64(n.iv_and_e?a.concat(n.iv,i):i),algo:this.algo};n.iv_and_e||(s.iv=o.bytesToBase64(n.iv)),r(s)},(e)=>i(`AES encrypt: CryptoSubtle error (${e}).`))})}decrypt(e,n,r){return new Promise((o,a)=>{r||(r=e.slice(0,t.AES_IV_LENGTH),e=e.slice(t.AES_IV_LENGTH)),crypto.subtle.decrypt({name:n,iv:r.buffer},this.key,e.buffer).then((e)=>o(new Uint8Array(e)),(e)=>a(`AES decrypt: CryptoSubtle error (${e}).`))})}wrapAESKey(e,n){return new Promise((r,i)=>{n=n||{},n.iv=n.iv||o.randomBytes(t.AES_IV_LENGTH),crypto.subtle.wrapKey('raw',e.key,this.key,{name:'AES-CBC',iv:n.iv.buffer}).then((e)=>{let t=new Uint8Array(e),i={cipherText:o.bytesToBase64(n.iv_and_e?a.concat(n.iv,t):t),algo:this.algo};n.iv_and_e||(i.iv=o.bytesToBase64(n.iv)),r(i),t.fill(0)},(e)=>i(`AES wrap key: CryptoSubtle error (${e}).`))})}unwrapAESKey(e,n){return new Promise((r,o)=>{n=n||{};let a;n.iv?a=e:(n.iv=e.slice(0,t.AES_IV_LENGTH),a=e.slice(t.AES_IV_LENGTH)),crypto.subtle.unwrapKey('raw',a.buffer,this.key,{name:this.algo,iv:n.iv.buffer},{name:n.algo||'AES-CBC'},!!n.exportable,['encrypt','decrypt','wrapKey','unwrapKey']).then((e)=>r(new i(e)),(e)=>o(`AES unwrap key: CryptoSubtle error (${e}).`))})}export(){return new Promise((e,t)=>{crypto.subtle.exportKey('raw',this.key).then((t)=>e(new Uint8Array(t)),(e)=>t(`AES export key: CryptoSubtle error (${e}).`))})}constructor(e){this.key=e,this.algo=e.algorithm.name}}t.AESKey=i},function(e,t){'use strict';function n(e){return Math.ceil(Math.log2(e+1)/8)}function r(e,t){if(0==e.length)return 0;let n=128<=e[0]&&t?-o(256,e.length):0;for(let r=e.length-1,o=1;0<=r;r--,o*=256)n+=e[r]*o;return n}Object.defineProperty(t,'__esModule',{value:!0}),t.EOC=0,t.INTEGER=2,t.BIT_STR=3,t.OCT_STR=4,t.SEQUENCE=48,t.encodeToDER=function(e,t){let r,o=1;if(128<=t.length){let e=n(t.length);o+=e,r=new Uint8Array(2+e+t.length),r[1]=128+e;for(let o=t.length,n=1+e;0<o;o=a(o/256),n--)r[n]=o%256}else r=new Uint8Array(2+t.length),r[1]=t.length;return r[0]=e,r.set(t,1+o),r},t.base256Len=n,t.unsigned=function(e){if(0==e.length)throw new Error('Attempted to convert an empty Uint8Array to an unsigned buffer.');let t=0;for(;0==e[t];)t++;return 0==t?128<=e[t]?new Uint8Array([0,...e]):e:128<=e[t]?e.slice(t-1):e.slice(t)},t.concat=function(...e){let t=0;for(let n=0;n<e.length;n++)t+=e[n].length;let n=new Uint8Array(t),r=0;for(let t=0;t<e.length;t++)n.set(e[t],r),r+=e[t].length;return n},t.decodeDER=function(e){if(0==e[0])return{type:0,content:new Uint8Array(0),remaining:e.slice(1)};let t=0,n=0;if(128<e[1])t=2+(e[1]-128),n=r(e.slice(2,t));else if(0<e[1]&&128>e[1])t=2,n=e[1];else throw new Error(`Bad ASN length identifier (${e[1]}).`);return{type:e[0],content:e.slice(t,t+n),remaining:e.slice(t+n)}},t.decodeBase256Integer=r},function(e,t,n){t.encode=function(e,t){var n=new r(t);return n.write(e),n.read()};var r=n(12).EncodeBuffer},function(e,t,n){function r(e){if(!(this instanceof r))return new r(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}t.EncodeBuffer=r;var o=n(3).preset,a=n(16).FlexEncoder;a.mixin(r.prototype),r.prototype.codec=o,r.prototype.write=function(e){this.codec.encode(this,e)}},function(t,n,r){'use strict';(function(t){function i(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(e,t){if(i()<t)throw new RangeError('Invalid typed array length');return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=l.prototype):(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!l.TYPED_ARRAY_SUPPORT&&!(this instanceof l))return new l(e,t,n);if('number'==typeof e){if('string'==typeof t)throw new Error('If encoding is specified then the first argument must be a string');return u(this,e)}return p(this,e,t,n)}function p(e,t,n,r){if('number'==typeof t)throw new TypeError('"value" argument must not be a number');return'undefined'!=typeof ArrayBuffer&&t instanceof ArrayBuffer?g(e,t,n,r):'string'==typeof t?y(e,t,n):b(e,t)}function d(e){if('number'!=typeof e)throw new TypeError('"size" argument must be a number');else if(0>e)throw new RangeError('"size" argument must not be negative')}function c(e,t,n,r){return d(t),0>=t?f(e,t):void 0===n?f(e,t):'string'==typeof r?f(e,t).fill(n,r):f(e,t).fill(n)}function u(e,t){if(d(t),e=f(e,0>t?0:0|m(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function y(e,t,n){if(('string'!=typeof n||''===n)&&(n='utf8'),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|E(t,n);e=f(e,r);var o=e.write(t,n);return o!==r&&(e=e.slice(0,o)),e}function h(e,t){var n=0>t.length?0:0|m(t.length);e=f(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function g(e,t,n,r){if(t.byteLength,0>n||t.byteLength<n)throw new RangeError('\'offset\' is out of bounds');if(t.byteLength<n+(r||0))throw new RangeError('\'length\' is out of bounds');return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),l.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=l.prototype):e=h(e,t),e}function b(e,t){if(l.isBuffer(t)){var n=0|m(t.length);return(e=f(e,n),0===e.length)?e:(t.copy(e,0,0,n),e)}if(t){if('undefined'!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||'length'in t)return'number'!=typeof t.length||Z(t.length)?f(e,0):h(e,t);if('Buffer'===t.type&&te(t.data))return h(e,t.data)}throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')}function m(e){if(e>=i())throw new RangeError('Attempt to allocate Buffer larger than maximum size: 0x'+i().toString(16)+' bytes');return 0|e}function E(e,t){if(l.isBuffer(e))return e.length;if('undefined'!=typeof ArrayBuffer&&'function'==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;'string'!=typeof e&&(e=''+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case'ascii':case'latin1':case'binary':return n;case'utf8':case'utf-8':case void 0:return q(e).length;case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return 2*n;case'hex':return n>>>1;case'base64':return X(e).length;default:if(r)return q(e).length;t=(''+t).toLowerCase(),r=!0;}}function A(e,t,n){var r=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return'';if((void 0===n||n>this.length)&&(n=this.length),0>=n)return'';if(n>>>=0,t>>>=0,n<=t)return'';for(e||(e='utf8');;)switch(e){case'hex':return K(this,t,n);case'utf8':case'utf-8':return U(this,t,n);case'ascii':return C(this,t,n);case'latin1':case'binary':return D(this,t,n);case'base64':return w(this,t,n);case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return L(this,t,n);default:if(r)throw new TypeError('Unknown encoding: '+e);e=(e+'').toLowerCase(),r=!0;}}function B(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function _(e,t,n,r,o){if(0===e.length)return-1;if('string'==typeof n?(r=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),0>n&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(0>n)if(o)n=0;else return-1;if('string'==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,o);if('number'==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&'function'==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,o);throw new TypeError('val must be string, number or Buffer')}function v(e,t,n,r,o){function a(e,t){return 1==s?e[t]:e.readUInt16BE(t*s)}var s=1,f=e.length,l=t.length;if(void 0!==r&&(r=(r+'').toLowerCase(),'ucs2'===r||'ucs-2'===r||'utf16le'===r||'utf-16le'===r)){if(2>e.length||2>t.length)return-1;s=2,f/=2,l/=2,n/=2}var p;if(o){var i=-1;for(p=n;p<f;p++)if(a(e,p)!==a(t,-1==i?0:p-i))-1!=i&&(p-=p-i),i=-1;else if(-1==i&&(i=p),p-i+1===l)return i*s}else for(n+l>f&&(n=f-l),p=n;0<=p;p--){for(var d=!0,c=0;c<l;c++)if(a(e,p+c)!==a(t,c)){d=!1;break}if(d)return p}return-1}function x(e,t,n,r){n=+n||0;var o=e.length-n;r?(r=+r,r>o&&(r=o)):r=o;var a=t.length;if(0!=a%2)throw new TypeError('Invalid hex string');r>a/2&&(r=a/2);for(var s,f=0;f<r;++f){if(s=parseInt(t.substr(2*f,2),16),isNaN(s))return f;e[n+f]=s}return f}function S(e,t,n,r){return J(q(t,e.length-n),e,n,r)}function P(e,t,n,r){return J(Q(t),e,n,r)}function R(e,t,n,r){return P(e,t,n,r)}function T(e,t,n,r){return J(X(t),e,n,r)}function k(e,t,n,r){return J(W(t,e.length-n),e,n,r)}function w(e,t,n){return 0===t&&n===e.length?$.fromByteArray(e):$.fromByteArray(e.slice(t,n))}function U(t,n,r){r=e(t.length,r);for(var o=[],a=n;a<r;){var i=t[a],s=null,f=239<i?4:223<i?3:191<i?2:1;if(a+f<=r){var l,p,d,c;1==f?128>i&&(s=i):2==f?(l=t[a+1],128==(192&l)&&(c=(31&i)<<6|63&l,127<c&&(s=c))):3==f?(l=t[a+1],p=t[a+2],128==(192&l)&&128==(192&p)&&(c=(15&i)<<12|(63&l)<<6|63&p,2047<c&&(55296>c||57343<c)&&(s=c))):4==f?(l=t[a+1],p=t[a+2],d=t[a+3],128==(192&l)&&128==(192&p)&&128==(192&d)&&(c=(15&i)<<18|(63&l)<<12|(63&p)<<6|63&d,65535<c&&1114112>c&&(s=c))):void 0}null===s?(s=65533,f=1):65535<s&&(s-=65536,o.push(55296|1023&s>>>10),s=56320|1023&s),o.push(s),a+=f}return I(o)}function I(e){var t=e.length;if(t<=ne)return s.apply(String,e);for(var n='',r=0;r<t;)n+=s.apply(String,e.slice(r,r+=ne));return n}function C(t,n,r){var o='';r=e(t.length,r);for(var a=n;a<r;++a)o+=s(127&t[a]);return o}function D(t,n,r){var o='';r=e(t.length,r);for(var a=n;a<r;++a)o+=s(t[a]);return o}function K(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var o='',a=t;a<n;++a)o+=j(e[a]);return o}function L(e,t,n){for(var r=e.slice(t,n),o='',a=0;a<r.length;a+=2)o+=s(r[a]+256*r[a+1]);return o}function O(e,t,n){if(0!=e%1||0>e)throw new RangeError('offset is not uint');if(e+t>n)throw new RangeError('Trying to access beyond buffer length')}function N(e,t,n,r,o,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError('Index out of range')}function Y(t,n,r,o){0>n&&(n=65535+n+1);for(var a=0,i=e(t.length-r,2);a<i;++a)t[r+a]=(n&255<<8*(o?a:1-a))>>>8*(o?a:1-a)}function V(t,n,r,o){0>n&&(n=4294967295+n+1);for(var a=0,i=e(t.length-r,4);a<i;++a)t[r+a]=255&n>>>8*(o?a:3-a)}function M(e,t,n,r){if(n+r>e.length)throw new RangeError('Index out of range');if(0>n)throw new RangeError('Index out of range')}function H(e,t,n,r,o){return o||M(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),ee.write(e,t,n,r,23,4),n+4}function G(e,t,n,r,o){return o||M(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),ee.write(e,t,n,r,52,8),n+8}function F(e){if(e=z(e).replace(re,''),2>e.length)return'';for(;0!=e.length%4;)e+='=';return e}function z(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,'')}function j(e){return 16>e?'0'+e.toString(16):e.toString(16)}function q(e,t){t=t||Infinity;for(var n,r=e.length,o=null,a=[],s=0;s<r;++s){if(n=e.charCodeAt(s),55295<n&&57344>n){if(!o){if(56319<n){-1<(t-=3)&&a.push(239,191,189);continue}else if(s+1===r){-1<(t-=3)&&a.push(239,191,189);continue}o=n;continue}if(56320>n){-1<(t-=3)&&a.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&-1<(t-=3)&&a.push(239,191,189);if(o=null,128>n){if(0>(t-=1))break;a.push(n)}else if(2048>n){if(0>(t-=2))break;a.push(192|n>>6,128|63&n)}else if(65536>n){if(0>(t-=3))break;a.push(224|n>>12,128|63&n>>6,128|63&n)}else if(1114112>n){if(0>(t-=4))break;a.push(240|n>>18,128|63&n>>12,128|63&n>>6,128|63&n)}else throw new Error('Invalid code point')}return a}function Q(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function W(e,t){for(var n,r,o,a=[],s=0;s<e.length&&!(0>(t-=2));++s)n=e.charCodeAt(s),r=n>>8,o=n%256,a.push(o),a.push(r);return a}function X(e){return $.toByteArray(F(e))}function J(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function Z(e){return e!==e}var $=r(30),ee=r(31),te=r(32);n.Buffer=l,n.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},n.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=t.TYPED_ARRAY_SUPPORT===void 0?function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&'function'==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}():t.TYPED_ARRAY_SUPPORT,n.kMaxLength=i(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return p(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,'undefined'!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return c(null,e,t,n)},l.allocUnsafe=function(e){return u(null,e)},l.allocUnsafeSlow=function(e){return u(null,e)},l.isBuffer=function(e){return!!(null!=e&&e._isBuffer)},l.compare=function(t,n){if(!l.isBuffer(t)||!l.isBuffer(n))throw new TypeError('Arguments must be Buffers');if(t===n)return 0;for(var r=t.length,o=n.length,a=0,i=e(r,o);a<i;++a)if(t[a]!==n[a]){r=t[a],o=n[a];break}return r<o?-1:o<r?1:0},l.isEncoding=function(e){switch((e+'').toLowerCase()){case'hex':case'utf8':case'utf-8':case'ascii':case'latin1':case'binary':case'base64':case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return!0;default:return!1;}},l.concat=function(e,t){if(!te(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},l.byteLength=E,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError('Buffer size must be a multiple of 16-bits');for(var t=0;t<e;t+=2)B(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError('Buffer size must be a multiple of 32-bits');for(var t=0;t<e;t+=4)B(this,t,t+3),B(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError('Buffer size must be a multiple of 64-bits');for(var t=0;t<e;t+=8)B(this,t,t+7),B(this,t+1,t+6),B(this,t+2,t+5),B(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0==e?'':0===arguments.length?U(this,0,e):A.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError('Argument must be a Buffer');return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e='',t=n.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString('hex',0,t).match(/.{2}/g).join(' '),this.length>t&&(e+=' ... ')),'<Buffer '+e+'>'},l.prototype.compare=function(t,n,r,o,a){if(!l.isBuffer(t))throw new TypeError('Argument must be a Buffer');if(void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),void 0===o&&(o=0),void 0===a&&(a=this.length),0>n||r>t.length||0>o||a>this.length)throw new RangeError('out of range index');if(o>=a&&n>=r)return 0;if(o>=a)return-1;if(n>=r)return 1;if(n>>>=0,r>>>=0,o>>>=0,a>>>=0,this===t)return 0;for(var s=a-o,f=r-n,p=e(s,f),d=this.slice(o,a),c=t.slice(n,r),u=0;u<p;++u)if(d[u]!==c[u]){s=d[u],f=c[u];break}return s<f?-1:f<s?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r='utf8',n=this.length,t=0;else if(void 0===n&&'string'==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t|=0,isFinite(n)?(n|=0,void 0===r&&(r='utf8')):(r=n,n=void 0);else throw new Error('Buffer.write(string, encoding, offset[, length]) is no longer supported');var o=this.length-t;if((void 0===n||n>o)&&(n=o),0<e.length&&(0>n||0>t)||t>this.length)throw new RangeError('Attempt to write outside buffer bounds');r||(r='utf8');for(var a=!1;;)switch(r){case'hex':return x(this,e,t,n);case'utf8':case'utf-8':return S(this,e,t,n);case'ascii':return P(this,e,t,n);case'latin1':case'binary':return R(this,e,t,n);case'base64':return T(this,e,t,n);case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return k(this,e,t,n);default:if(a)throw new TypeError('Unknown encoding: '+r);r=(''+r).toLowerCase(),a=!0;}},l.prototype.toJSON=function(){return{type:'Buffer',data:Array.prototype.slice.call(this._arr||this,0)}};var ne=4096;l.prototype.slice=function(e,t){var n=this.length;e=~~e,t=t===void 0?n:~~t,0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),t<e&&(t=e);var r;if(l.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=l.prototype;else{var o=t-e;r=new l(o,void 0);for(var a=0;a<o;++a)r[a]=this[a+e]}return r},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],o=1,a=0;++a<t&&(o*=256);)r+=this[e+a]*o;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e+--t],o=1;0<t&&(o*=256);)r+=this[e+--t]*o;return r},l.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],a=1,s=0;++s<t&&(a*=256);)r+=this[e+s]*a;return a*=128,r>=a&&(r-=o(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=t,a=1,i=this[e+--r];0<r&&(a*=256);)i+=this[e+--r]*a;return a*=128,i>=a&&(i-=o(2,8*t)),i},l.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),ee.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),ee.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),ee.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),ee.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){var a=o(2,8*n)-1;N(this,e,t,n,a,0)}var s=1,f=0;for(this[t]=255&e;++f<n&&(s*=256);)this[t+f]=255&e/s;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){var a=o(2,8*n)-1;N(this,e,t,n,a,0)}var s=n-1,i=1;for(this[t+s]=255&e;0<=--s&&(i*=256);)this[t+s]=255&e/i;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=a(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Y(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Y(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):V(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=o(2,8*n-1);N(this,e,t,n,a-1,-a)}var s=0,i=1,f=0;for(this[t]=255&e;++s<n&&(i*=256);)0>e&&0==f&&0!==this[t+s-1]&&(f=1),this[t+s]=255&(e/i>>0)-f;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=o(2,8*n-1);N(this,e,t,n,a-1,-a)}var s=n-1,i=1,f=0;for(this[t+s]=255&e;0<=--s&&(i*=256);)0>e&&0==f&&0!==this[t+s+1]&&(f=1),this[t+s]=255&(e/i>>0)-f;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=a(e)),0>e&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Y(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Y(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):V(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return H(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return H(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return G(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return G(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError('targetStart out of bounds');if(0>n||n>=this.length)throw new RangeError('sourceStart out of bounds');if(0>r)throw new RangeError('sourceEnd out of bounds');r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,a=r-n;if(this===e&&n<t&&t<r)for(o=a-1;0<=o;--o)e[o+t]=this[o+n];else if(1e3>a||!l.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},l.prototype.fill=function(e,t,n,r){if('string'==typeof e){if('string'==typeof t?(r=t,t=0,n=this.length):'string'==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);256>o&&(e=o)}if(void 0!==r&&'string'!=typeof r)throw new TypeError('encoding must be a string');if('string'==typeof r&&!l.isEncoding(r))throw new TypeError('Unknown encoding: '+r)}else'number'==typeof e&&(e&=255);if(0>t||this.length<t||this.length<n)throw new RangeError('Out of range index');if(n<=t)return this;t>>>=0,n=n===void 0?this.length:n>>>0,e||(e=0);var a;if('number'==typeof e)for(a=t;a<n;++a)this[a]=e;else{var i=l.isBuffer(e)?e:q(new l(e,r).toString()),s=i.length;for(a=0;a<n-t;++a)this[a+t]=i[a%s]}return this};var re=/[^+\/0-9A-Za-z-_]/g}).call(n,r(29))},function(e,i){i.read=function(t,n,r,a,f){var l,e,p=8*f-a-1,c=(1<<p)-1,u=c>>1,y=-7,h=r?f-1:0,i=r?-1:1,d=t[n+h];for(h+=i,l=d&(1<<-y)-1,d>>=-y,y+=p;0<y;l=256*l+t[n+h],h+=i,y-=8);for(e=l&(1<<-y)-1,l>>=-y,y+=a;0<y;e=256*e+t[n+h],h+=i,y-=8);if(0===l)l=1-u;else{if(l===c)return e?NaN:(d?-1:1)*Infinity;e+=o(2,a),l-=u}return(d?-1:1)*e*o(2,l-a)},i.write=function(f,l,p,u,y,h){var g,b,m,c=8*h-y-1,E=(1<<c)-1,A=E>>1,B=23===y?5.960464477539063e-8-6.617444900424222e-24:0,_=u?0:h-1,i=u?1:-1,d=0>l||0===l&&0>1/l?1:0;for(l=r(l),isNaN(l)||l===Infinity?(b=isNaN(l)?1:0,g=E):(g=a(n(l)/t),1>l*(m=o(2,-g))&&(g--,m*=2),l+=1<=g+A?B/m:B*o(2,1-A),2<=l*m&&(g++,m/=2),g+A>=E?(b=0,g=E):1<=g+A?(b=(l*m-1)*o(2,y),g+=A):(b=l*o(2,A-1)*o(2,y),g=0));8<=y;f[p+_]=255&b,_+=i,b/=256,y-=8);for(g=g<<y|b,c+=y;0<c;f[p+_]=255&g,_+=i,g/=256,c-=8);f[p+_-i]|=128*d}},function(e,t){function n(e){return function(t){var n=t.reserve(1);t.buffer[n]=e}}for(var r=t.uint8=Array(256),o=0;255>=o;o++)r[o]=n(o)},function(t,n,r){function o(){if(!(this instanceof o))return new o}function a(){if(!(this instanceof a))return new a}function i(){throw new Error('method not implemented: write()')}function s(){throw new Error('method not implemented: fetch()')}function f(){var e=this.buffers&&this.buffers.length;return e?(this.flush(),this.pull()):this.fetch()}function l(e){var t=this.buffers||(this.buffers=[]);t.push(e)}function p(){var e=this.buffers||(this.buffers=[]);return e.shift()}function d(e){return function(t){for(var n in e)t[n]=e[n];return t}}n.FlexDecoder=o,n.FlexEncoder=a;var c=r(0),u='BUFFER_SHORTAGE';o.mixin=d(function(){return{bufferish:c,write:function(e){var t=this.offset?c.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=t?e?this.bufferish.concat([t,e]):t:e,this.offset=0},fetch:s,flush:function(){for(;this.offset<this.buffer.length;){var e,t=this.offset;try{e=this.fetch()}catch(n){if(n&&n.message!=u)throw n;this.offset=t;break}this.push(e)}},push:l,pull:p,read:f,reserve:function(e){var t=this.offset,n=t+e;if(n>this.buffer.length)throw new Error(u);return this.offset=n,t},offset:0}}()),o.mixin(o.prototype),a.mixin=d(function(){return{bufferish:c,write:i,fetch:function(){var e=this.start;if(e<this.offset){var t=this.start=this.offset;return c.prototype.slice.call(this.buffer,e,t)}},flush:function(){for(;this.start<this.offset;){var e=this.fetch();e&&this.push(e)}},push:l,pull:function(){var e=this.buffers||(this.buffers=[]),t=1<e.length?this.bufferish.concat(e):e[0];return e.length=0,t},read:f,reserve:function(t){var n=Math.max,r=0|t;if(this.buffer){var o=this.buffer.length,a=0|this.offset,i=a+r;if(i<o)return this.offset=i,a;this.flush(),t=n(t,e(2*o,this.maxBufferSize))}return t=n(t,this.minBufferSize),this.buffer=this.bufferish.alloc(t),this.start=0,this.offset=r,0},send:function(e){var t=e.length;if(t>this.minBufferSize)this.flush(),this.push(e);else{var n=this.reserve(t);c.prototype.copy.call(e,this.buffer,n)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),a.mixin(a.prototype)},function(e,t,n){t.decode=function(e,t){var n=new r(t);return n.write(e),n.read()};var r=n(18).DecodeBuffer},function(e,t,n){function r(e){if(!(this instanceof r))return new r(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}t.DecodeBuffer=r;var o=n(8).preset,a=n(16).FlexDecoder;a.mixin(r.prototype),r.prototype.codec=o,r.prototype.fetch=function(){return this.codec.decode(this)}},function(e,t,n){function r(e,t){var n,r={},o=Array(t),a=Array(t),i=e.codec.decode;for(n=0;n<t;n++)o[n]=i(e),a[n]=i(e);for(n=0;n<t;n++)r[o[n]]=a[n];return r}function o(e,t){var n,r=new Map,o=Array(t),a=Array(t),i=e.codec.decode;for(n=0;n<t;n++)o[n]=i(e),a[n]=i(e);for(n=0;n<t;n++)r.set(o[n],a[n]);return r}function a(e,t){for(var n=Array(t),r=e.codec.decode,o=0;o<t;o++)n[o]=r(e);return n}function i(e,t){var n=e.reserve(t);return T.toString.call(e.buffer,'utf-8',n,n+t)}function s(e,t){var n=e.reserve(t),r=T.slice.call(e.buffer,n,n+t);return R.from(r)}function f(e,t){var n=e.reserve(t),r=T.slice.call(e.buffer,n,n+t);return R.Uint8Array.from(r).buffer}function l(e,t){var n=e.reserve(t+1),r=e.buffer[n++],o=n+t,a=e.codec.getExtUnpacker(r);if(!a)throw new Error('Invalid ext type: '+(r?'0x'+r.toString(16):r));var i=T.slice.call(e.buffer,n,o);return a(i)}function p(e){var t=e.reserve(1);return e.buffer[t]}function d(e){var t=e.reserve(1),n=e.buffer[t];return 128&n?n-256:n}function c(e){var t=e.reserve(2),n=e.buffer;return n[t++]<<8|n[t]}function u(e){var t=e.reserve(2),n=e.buffer,r=n[t++]<<8|n[t];return 32768&r?r-65536:r}function y(e){var t=e.reserve(4),n=e.buffer;return 16777216*n[t++]+(n[t++]<<16)+(n[t++]<<8)+n[t]}function h(e){var t=e.reserve(4),n=e.buffer;return n[t++]<<24|n[t++]<<16|n[t++]<<8|n[t]}function g(e,t){return function(n){var r=n.reserve(e);return t.call(n.buffer,r,w)}}function b(e){return new S(this,e).toNumber()}function m(e){return new P(this,e).toNumber()}function E(e){return new S(this,e)}function A(e){return new P(this,e)}function B(e){return v.read(this,e,!1,23,4)}function _(e){return v.read(this,e,!1,52,8)}var v=n(14),x=n(7),S=x.Uint64BE,P=x.Int64BE;t.getReadFormat=function(e){var t=R.hasArrayBuffer&&e&&e.binarraybuffer,n=e&&e.int64,v=k&&e&&e.usemap,x={map:v?o:r,array:a,str:i,bin:t?f:s,ext:l,uint8:p,uint16:c,uint32:y,uint64:g(8,n?E:b),int8:d,int16:u,int32:h,int64:g(8,n?A:m),float32:g(4,B),float64:g(8,_)};return x},t.readUint8=p;var R=n(0),T=n(6),k='undefined'!=typeof Map,w=!0},function(e){function t(){if(!(this instanceof t))return new t}(function(t){function n(e){for(var t in i)e[t]=i[t];return e}function r(e,t){function n(e){return e!==t&&e.originalListener!==t}var i,s=this;if(!arguments.length)delete s[a];else if(!t){if(i=s[a],i&&(delete i[e],!Object.keys(i).length))return r.call(s);}else if(i=o(s,e,!0),i){if(i=i.filter(n),!i.length)return r.call(s,e);s[a][e]=i}return s}function o(e,t,n){if(!n||e[a]){var r=e[a]||(e[a]={});return r[t]||(r[t]=[])}}e.exports=t;var a='listeners',i={on:function(e,t){return o(this,e).push(t),this},once:function(e,t){function n(){r.call(a,e,n),t.apply(this,arguments)}var a=this;return n.originalListener=t,o(a,e).push(n),a},off:r,emit:function(e,t){function n(e){e.apply(r,s)}var r=this,a=o(r,e,!0);if(!a)return!1;var i=arguments.length;if(1===i)a.forEach(function(e){e.call(r)});else if(2===i)a.forEach(function(e){e.call(r,t)});else{var s=Array.prototype.slice.call(arguments,1);a.forEach(n)}return!!a.length}};n(t.prototype),t.mixin=n})(t)},function(e,t){'use strict';function n(e){for(let t=e.byteLength-1;0<=t;t--){if(255>e[t])return void e[t]++;e[t]=0}throw new Error(`exhausted nonce of ${e.byteLength} bytes`)}Object.defineProperty(t,'__esModule',{value:!0}),t.VERSION={maj:0,min:0,pat:0};t.MessageCipher=class{constructor(e,t,n,r){this.sealKey=e,this.sealNonce=t,this.openKey=n,this.openNonce=r}encryptMessage(e){return this.sealKey.encrypt(e,{iv:this.sealNonce}).then((e)=>(n(this.sealNonce),{cipherText:e.cipherText,tag:e.tag}))}decryptMessage(e){return this.openKey.decrypt(e.cipherText,this.openNonce,e.tag).then((e)=>(n(this.openNonce),e))}}},function(e,t,n){'use strict';function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,'__esModule',{value:!0}),r(n(23)),r(n(21)),r(n(46))},function(e,t,n){'use strict';function r(e){return o(this,void 0,void 0,function*(){return new Promise((t,n)=>{e.onmessage=(n)=>{e.onmessage=null,t(n)},e.onerror=()=>{e.onerror=null,n()}})})}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{f(r.next(e))}catch(t){a(t)}}function s(e){try{f(r['throw'](e))}catch(t){a(t)}}function f(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}f((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,'__esModule',{value:!0});const a=n(24),i=n(26),s=n(27),f=n(21);s.codec.preset.addExtPacker(0,Date,function(e){return s.encode(e.getTime())}),s.codec.preset.addExtUnpacker(0,function(e){return new Date(s.decode(e))});var l;(function(e){e[e.Normal=1e3]='Normal',e[e.GoingAway=1001]='GoingAway',e[e.ProtocolError=1002]='ProtocolError',e[e.UnsupportedData=1003]='UnsupportedData',e[e.InvalidPayload=1007]='InvalidPayload',e[e.PolicyViolation=1008]='PolicyViolation',e[e.MessageTooBig=1009]='MessageTooBig',e[e.MissingExtension=1010]='MissingExtension',e[e.InternalError=1011]='InternalError',e[e.ServiceRestart=1012]='ServiceRestart',e[e.TryAgainLater=1013]='TryAgainLater',e[e.BadGateway=1014]='BadGateway'})(l=t.CloseCode||(t.CloseCode={}));class p extends i.EventEmitter{constructor(e,t){super(),this.socket=e,this.cipher=t,this.requestCounter=0,this.closed=!1,e.onmessage=(e)=>{let t;try{t=s.decode(e.data)}catch(t){return void console.error('received bad msgpack:',e.data)}this.cipher.decryptMessage(t).then((e)=>{let t=s.decode(e);this.emit(t.type,t.id,t.payload)},(e)=>console.log('VM connection decryption error:',e))}}send(e,t){if(this.closed)throw new Error('attempt to send message on closed VM connection');let n={mtype:'request',id:this.requestCounter,type:e,payload:t||void 0};return this.cipher.encryptMessage(s.encode(n)).then((e)=>this.socket.send(s.encode(e).buffer),(e)=>console.log('VM connection encryption error:',e)),this.requestCounter++}write(e,t){if(this.closed)throw new Error('attempt to write to a stream on a closed VM connection');this.cipher.encryptMessage(s.encode({mtype:'stream',id:e,payload:t||void 0})).then((e)=>this.socket.send(s.encode(e).buffer),(e)=>console.log('VM connection encryption error:',e))}disconnect(e,t){if(this.closed)throw new Error('attempt to close already closed VM connection');if(t&&123<t.length)throw new Error('reason for closing is greater than 123 characters');this.socket.close(e||l.Normal,t),this.closed=!0}}p.PROTOCOL_VERSION=0,p.NONCE_SIZE=12,t.VMConnection=p,t.dial=function(e,t,n){return o(this,void 0,void 0,function*(){let o=yield a.genECDHPair('P-256',!0),i=yield o.public.export('spki'),l=yield n.private.sign(i),d=new Uint8Array(p.NONCE_SIZE),c={version:p.PROTOCOL_VERSION,key:i,sig:l,nonce:d,user:t},u=new WebSocket(e);u.send(s.encode(c));let y=s.decode((yield r(u)).data);if(y.version!=p.PROTOCOL_VERSION)throw new Error('mismatched client/server protocol version');let h=yield a.importECDHPublic(y.key,'spki','P-256'),g=yield o.private.deriveBytes(h,32),b=yield(yield a.importPBKDF2Key(g)).deriveBytes(64,y.iterations,'SHA-256'),m=yield a.importAESKey(b.subarray(0,32),'AES-GCM'),E=yield a.importAESKey(b.subarray(32,64),'AES-GCM');return new p(u,new f.MessageCipher(E,d,m,y.nonce))})}},function(e,t,n){'use strict';function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,'__esModule',{value:!0}),r(n(2)),r(n(9)),r(n(25))},function(e,t,n){'use strict';function r(e){return new Promise((t,n)=>{let r=f(e);Promise.all([crypto.subtle.importKey('spki',r.buffer,{name:'RSA-PSS',hash:{name:'SHA-256'}},!0,['verify']),crypto.subtle.importKey('spki',r.buffer,{name:'RSA-OAEP',hash:{name:'SHA-256'}},!0,['encrypt','wrapKey'])]).then(([e,n])=>t(new u(e,n)),(e)=>n(new Error(`RSA import public: CryptoSubtle error (${e}).`)))})}function o(e,t){return new Promise((n,r)=>{crypto.subtle.importKey('raw',t.buffer,{name:'PBKDF2'},!1,['deriveKey']).then((o)=>{t.fill(0);let a=e.kdf.split(':');crypto.subtle.deriveKey({name:a[0],salt:p.base64ToBytes(e.salt).buffer,iterations:e.rounds,hash:{name:a[1]}},o,{name:e.encAlgo,length:8*e.encSize},!1,['unwrapKey']).then((t)=>{let o=p.base64ToBytes(e.encrypted),a=p.base64ToBytes(e.iv).buffer;Promise.all([crypto.subtle.unwrapKey(e.encoding,o,t,{name:e.encAlgo,iv:a},{name:'RSA-PSS',hash:{name:'SHA-256'}},!1,['sign']),crypto.subtle.unwrapKey(e.encoding,o,t,{name:e.encAlgo,iv:a},{name:'RSA-OAEP',hash:{name:'SHA-256'}},!1,['decrypt','unwrapKey'])]).then(([e,t])=>{n(new y(e,t))},(e)=>r(`CryptoSubtle failed to unwrap key (${e}).`))},(e)=>r(`CryptoSubtle failed to derive unwrapping key (${e}).`))},(e)=>r(`CryptoSubtle failed to create derivation key from password (${e}).`))}).catch((e)=>{throw new Error(`RSA import private: ${e}`)})}function a(e){return new Promise((t,n)=>{crypto.subtle.exportKey('spki',e).then((e)=>t(s(new Uint8Array(e))),(e)=>n(`RSA export public: CryptoSubtle error (${e}).`))})}function i(e,t,n){return new Promise((r,o)=>{let a=p.randomBytes(16),i=p.randomBytes(16);n=n||2e4,crypto.subtle.importKey('raw',t.buffer,{name:'PBKDF2'},!1,['deriveKey']).then((s)=>{t.fill(0),crypto.subtle.deriveKey({name:'PBKDF2',salt:a.buffer,iterations:n,hash:{name:'SHA-256'}},s,{name:'AES-CBC',length:256},!1,['wrapKey']).then((t)=>{crypto.subtle.wrapKey('pkcs8',e,t,{name:'AES-CBC',iv:i.buffer}).then((e)=>{r({encrypted:p.bytesToBase64(new Uint8Array(e)),encoding:'pkcs8',kdf:'PBKDF2:SHA-256',rounds:n,salt:p.bytesToBase64(a),encAlgo:'AES-CBC',encSize:32,iv:p.bytesToBase64(i)})},(e)=>o(`CryptoSubtle failed to wrap key (${e}).`))},(e)=>o(`CryptoSubtle failed to derive wrapping key (${e}).`))},(e)=>o(`CryptoSubtle failed to create derivation key from password (${e}).`))}).catch((e)=>{throw new Error(`RSA export private: ${e}`)})}function s(e){let t=c.decodeDER(e),n=c.decodeDER(t.content),r=c.decodeDER(n.remaining),o=c.decodeDER(r.content.slice(1)),a=c.decodeDER(o.content),i=c.decodeDER(a.remaining);return{modulus:p.bytesToBase64(a.content),publicExponent:p.bytesToBase64(i.content)}}function f(e){return l(p.base64ToBytes(e.modulus),p.base64ToBytes(e.publicExponent))}function l(t,n){t=c.encodeToDER(c.INTEGER,c.unsigned(t)),n=c.encodeToDER(c.INTEGER,c.unsigned(n));let e=c.encodeToDER(c.SEQUENCE,c.concat(t,n)),r=new Uint8Array(1+e.length);r[0]=c.EOC,r.set(e,1);const o=new Uint8Array([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);let a=c.encodeToDER(c.BIT_STR,r);return c.encodeToDER(c.SEQUENCE,c.concat(o,a))}Object.defineProperty(t,'__esModule',{value:!0});const p=n(2),d=n(9),c=n(10);t.convertOldKeyPair=function(e,t){const n=new Uint8Array([2,1,0]),r=new Uint8Array([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);return new Promise((o,a)=>{let i=p.base64ToBytes(e.key.privateKey.key),s=p.base64ToBytes(e.key.privateKey.salt),f=e.key.privateKey.iterations,l=p.base64ToBytes(e.key.privateKey.iv);crypto.subtle.importKey('raw',t.buffer,{name:'PBKDF2'},!1,['deriveKey']).then((d)=>{t.fill(0),crypto.subtle.deriveKey({name:'PBKDF2',salt:s.buffer,iterations:f,hash:{name:'SHA-256'}},d,{name:'AES-CBC',length:256},!1,['encrypt','decrypt']).then((t)=>{crypto.subtle.decrypt({name:'AES-CBC',iv:l.buffer},t,i.buffer).then((i)=>{let d=new TextDecoder('utf-8'),u=JSON.parse(d.decode(new Uint8Array(i))),y=u.map((e)=>c.encodeToDER(c.INTEGER,c.unsigned(p.base64ToBytes(e))));y.unshift(new Uint8Array([2,1,0]));let h=c.encodeToDER(c.OCT_STR,c.encodeToDER(c.SEQUENCE,c.concat(...y))),g=c.encodeToDER(c.SEQUENCE,c.concat(n,r,h));l=p.randomBytes(16),crypto.subtle.encrypt({name:'AES-CBC',iv:l.buffer},t,g.buffer).then((t)=>o({email:e.email,public:e.key.publicKey,private:{encrypted:p.bytesToBase64(new Uint8Array(t)),encoding:'pkcs8',kdf:'PBKDF2:SHA-256',rounds:f,salt:p.bytesToBase64(s),encAlgo:'AES-CBC',encSize:32,iv:p.bytesToBase64(l)}}),(e)=>a(`CryptoSubtle failed to rewrap key (${e}).`))},(e)=>a(`CryptoSubtle failed to unwrap key (${e}).`))},(e)=>a(`CryptoSubtle failed to derive unwrapping/re-wrapping key (${e}).`))},(e)=>a(`CryptoSubtle failed to create derivation key from password (${e}).`))}).catch((e)=>{throw new Error(`RSA convert deprecated key pair: ${e}`)})},t.genRSAKeyPair=function(e,t){return new Promise((n,r)=>{crypto.subtle.generateKey({name:'RSA-PSS',modulusLength:e||2048,publicExponent:t||new Uint8Array([1,0,1]),hash:{name:'SHA-256'}},!0,['sign','verify']).then((e)=>{Promise.all([crypto.subtle.exportKey('spki',e.publicKey),crypto.subtle.exportKey('pkcs8',e.privateKey)]).then(([t,o])=>{const a={name:'RSA-OAEP',hash:{name:'SHA-256'}};Promise.all([crypto.subtle.importKey('spki',t,a,!0,['encrypt','wrapKey']),crypto.subtle.importKey('pkcs8',o,a,!0,['decrypt','unwrapKey'])]).then(([t,r])=>{new Uint8Array(o).fill(0),n({public:new u(e.publicKey,t),private:new y(e.privateKey,r)})},(e)=>r(`RSA gen key: CryptoSubtle failed to re-import keys as OAEP (${e}).`))},(e)=>r(`RSA gen key: CryptoSubtle failed to export raw keys (${e}).`))},(e)=>r(`RSA gen key: CryptoSubtle error (${e}).`))})};t.genRSAKeyPairAndExport=function(e,t,n){return new Promise((r,o)=>{crypto.subtle.generateKey({name:'RSA-PSS',modulusLength:t||2048,publicExponent:n||new Uint8Array([1,0,1]),hash:{name:'SHA-256'}},!0,['sign','verify']).then((t)=>{i(t.privateKey,e).then((e)=>{a(t.publicKey).then((t)=>r({public:t,private:e}),(e)=>o(`RSA gen key: ${e}`))},(e)=>o(`RSA gen key: ${e}`))},(e)=>o(`RSA gen key: CryptoSubtle error (${e}).`))})};t.importRSAKeyPair=function(e,t){return Promise.all([r(e.public),o(e.private,t)]).then(([t,n])=>({email:e.email,public:t,private:n}))};class u{verify(e,t){return new Promise((n,r)=>{crypto.subtle.verify({name:'RSA-PSS',saltLength:t.saltLength},this.pss,p.base64ToBytes(t.signature).buffer,e.buffer).then(n,(e)=>r(`RSA verify: CryptoSubtle error (${e}).`))})}encrypt(e){return new Promise((t,n)=>{crypto.subtle.encrypt({name:'RSA-OAEP'},this.oaep,e.buffer).then((e)=>t(new Uint8Array(e)),(e)=>n(new Error(`RSA encrypt: CryptoSubtle error (${e}).`)))})}wrapAESKey(e){return new Promise((t,n)=>{if(!e.key.extractable)throw new Error('AES key cannot be wrapped because it is not exportable.');crypto.subtle.wrapKey('raw',e.key,this.oaep,{name:'RSA-OAEP',hash:{name:'SHA-256'}}).then((e)=>t(new Uint8Array(e)),(e)=>n(`RSA wrap key: CryptoSubtle error (${e})`))})}export(){return a(this.pss)}constructor(e,t){this.pss=e,this.oaep=t}}t.RSAPublic=u;class y{sign(e,t){return new Promise((n,r)=>{t=t?t:32,crypto.subtle.sign({name:'RSA-PSS',saltLength:t},this.pss,e.buffer).then((e)=>n({signature:p.bytesToBase64(new Uint8Array(e)),saltLength:t}),(e)=>r(new Error(`RSA sign: CryptoSubtle error (${e}).`)))})}signChallenge(e,t){return new Promise((n,r)=>{let o=p.base64ToBytes(e),a=p.randomBytes(32),i=new Uint8Array(o.length+a.length);i.set(o,0),i.set(a,o.length),this.sign(i,t).then((t)=>n({signature:t.signature,serverToken:e,clientToken:p.bytesToBase64(a),saltLen:t.saltLength}),r)})}decrypt(e){return new Promise((t,n)=>{crypto.subtle.decrypt({name:'RSA-OAEP'},this.oaep,e.buffer).then((e)=>t(new Uint8Array(e)),(e)=>n(`RSA decrypt: CryptoSubtle error (${e}).`))})}unwrapAESKey(e,t,n){return new Promise((r,o)=>{crypto.subtle.unwrapKey('raw',e.buffer,this.oaep,{name:'RSA-OAEP',hash:{name:'SHA-256'}},{name:t},!!n,['encrypt','decrypt','wrapKey','unwrapKey']).then((e)=>r(new d.AESKey(e)),(e)=>o(`RSA unwrap key: CryptoSubtle error (${e}).`))})}export(e,t){return i(this.pss,e,t)}extractPublic(){return new Promise((e,t)=>{crypto.subtle.exportKey('pkcs8',this.pss).then((n)=>{let r=c.decodeDER(c.decodeDER(c.decodeDER(c.decodeDER(c.decodeDER(new Uint8Array(n)).content).remaining).remaining).content).content,o=c.decodeDER(r),a=c.decodeDER(o.remaining),i=c.decodeDER(a.remaining),s=l(a.content,i.content);Promise.all([crypto.subtle.importKey('spki',s.buffer,{name:'RSA-PSS',hash:{name:'SHA-256'}},!0,['verify']),crypto.subtle.importKey('spki',s.buffer,{name:'RSA-OAEP',hash:{name:'SHA-256'}},!0,['encrypt','wrapKey'])]).then(([t,r])=>{e(new u(t,r)),new Uint8Array(n).fill(0)},(e)=>{t(`CryptoSubtle failed to import SPKI public key (${e}).`),new Uint8Array(n).fill(0)})},(e)=>t(`CryptoSubtle failed to export private to PKCS8 (${e}).`))}).catch((e)=>{throw new Error(`RSA extract public: ${e}`)})}constructor(e,t){this.pss=e,this.oaep=t}}t.RSAPrivate=y,t.importRSAPublic=r,t.importRSAPrivate=o},function(e){'use strict';function t(){}function n(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,r,o,a){if('function'!=typeof r)throw new TypeError('The listener must be a function');var i=new n(r,o||e,a),f=s?s+t:t;return e._events[f]?e._events[f].fn?e._events[f]=[e._events[f],i]:e._events[f].push(i):(e._events[f]=i,e._eventsCount++),e}function o(e,n){0==--e._eventsCount?e._events=new t:delete e._events[n]}function a(){this._events=new t,this._eventsCount=0}var i=Object.prototype.hasOwnProperty,s='~';Object.create&&(t.prototype=Object.create(null),!new t().__proto__&&(s=!1)),a.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)i.call(e,t)&&n.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=s?s+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=Array(o);r<o;r++)a[r]=n[r].fn;return a},a.prototype.listenerCount=function(e){var t=s?s+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,r,o,a){var f=s?s+e:e;if(!this._events[f])return!1;var l,p,i=this._events[f],d=arguments.length;if(i.fn){switch(i.once&&this.removeListener(e,i.fn,void 0,!0),d){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,t),!0;case 3:return i.fn.call(i.context,t,n),!0;case 4:return i.fn.call(i.context,t,n,r),!0;case 5:return i.fn.call(i.context,t,n,r,o),!0;case 6:return i.fn.call(i.context,t,n,r,o,a),!0;}for(p=1,l=Array(d-1);p<d;p++)l[p-1]=arguments[p];i.fn.apply(i.context,l)}else{var c,u=i.length;for(p=0;p<u;p++)switch(i[p].once&&this.removeListener(e,i[p].fn,void 0,!0),d){case 1:i[p].fn.call(i[p].context);break;case 2:i[p].fn.call(i[p].context,t);break;case 3:i[p].fn.call(i[p].context,t,n);break;case 4:i[p].fn.call(i[p].context,t,n,r);break;default:if(!l)for(c=1,l=Array(d-1);c<d;c++)l[c-1]=arguments[c];i[p].fn.apply(i[p].context,l);}}return!0},a.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,n,r){var a=s?s+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var f=this._events[a];if(f.fn)f.fn!==t||r&&!f.once||n&&f.context!==n||o(this,a);else{for(var l=0,i=[],p=f.length;l<p;l++)(f[l].fn!==t||r&&!f[l].once||n&&f[l].context!==n)&&i.push(f[l]);i.length?this._events[a]=1===i.length?i[0]:i:o(this,a)}return this},a.prototype.removeAllListeners=function(e){var n;return e?(n=s?s+e:e,this._events[n]&&o(this,n)):(this._events=new t,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,e.exports=a},function(e,t,n){t.encode=n(11).encode,t.decode=n(17).decode,t.Encoder=n(42).Encoder,t.Decoder=n(43).Decoder,t.createCodec=n(44).createCodec,t.codec=n(45).codec},function(e,t,n){(function(t){function n(e){return e&&e.isBuffer&&e}e.exports=n('undefined'!=typeof t&&t)||n(this.Buffer)||n('undefined'!=typeof window&&window.Buffer)||this.Buffer}).call(t,n(13).Buffer)},function(e){var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(n){'object'==typeof window&&(t=window)}e.exports=t},function(e,t){'use strict';function n(e){var t=e.length;if(0<t%4)throw new Error('Invalid string. Length must be a multiple of 4');return'='===e[t-2]?2:'='===e[t-1]?1:0}function r(e){return a[63&e>>18]+a[63&e>>12]+a[63&e>>6]+a[63&e]}function o(e,t,n){for(var o,a=[],s=t;s<n;s+=3)o=(e[s]<<16)+(e[s+1]<<8)+e[s+2],a.push(r(o));return a.join('')}t.byteLength=function(e){return 3*e.length/4-n(e)},t.toByteArray=function(e){var t,r,o,a,i,l=e.length;a=n(e),i=new f(3*l/4-a),r=0<a?l-4:l;var p=0;for(t=0;t<r;t+=4)o=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],i[p++]=255&o>>16,i[p++]=255&o>>8,i[p++]=255&o;return 2===a?(o=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,i[p++]=255&o):1===a&&(o=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,i[p++]=255&o>>8,i[p++]=255&o),i},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,s='',f=[],l=16383,p=0,i=n-r;p<i;p+=l)f.push(o(e,p,p+l>i?i:p+l));return 1==r?(t=e[n-1],s+=a[t>>2],s+=a[63&t<<4],s+='=='):2==r&&(t=(e[n-2]<<8)+e[n-1],s+=a[t>>10],s+=a[63&t>>4],s+=a[63&t<<2],s+='='),f.push(s),f.join('')};for(var a=[],s=[],f='undefined'==typeof Uint8Array?Array:Uint8Array,l='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',p=0,i=l.length;p<i;++p)a[p]=l[p],s[l.charCodeAt(p)]=p;s[45]=62,s[95]=63},function(e,i){i.read=function(t,n,r,a,f){var l,e,p=8*f-a-1,c=(1<<p)-1,u=c>>1,y=-7,h=r?f-1:0,i=r?-1:1,d=t[n+h];for(h+=i,l=d&(1<<-y)-1,d>>=-y,y+=p;0<y;l=256*l+t[n+h],h+=i,y-=8);for(e=l&(1<<-y)-1,l>>=-y,y+=a;0<y;e=256*e+t[n+h],h+=i,y-=8);if(0===l)l=1-u;else{if(l===c)return e?NaN:(d?-1:1)*Infinity;e+=o(2,a),l-=u}return(d?-1:1)*e*o(2,l-a)},i.write=function(f,l,p,u,y,h){var g,b,m,c=8*h-y-1,E=(1<<c)-1,A=E>>1,B=23===y?5.960464477539063e-8-6.617444900424222e-24:0,_=u?0:h-1,i=u?1:-1,d=0>l||0===l&&0>1/l?1:0;for(l=r(l),isNaN(l)||l===Infinity?(b=isNaN(l)?1:0,g=E):(g=a(n(l)/t),1>l*(m=o(2,-g))&&(g--,m*=2),l+=1<=g+A?B/m:B*o(2,1-A),2<=l*m&&(g++,m/=2),g+A>=E?(b=0,g=E):1<=g+A?(b=(l*m-1)*o(2,y),g+=A):(b=l*o(2,A-1)*o(2,y),g=0));8<=y;f[p+_]=255&b,_+=i,b/=256,y-=8);for(g=g<<y|b,c+=y;0<c;f[p+_]=255&g,_+=i,g/=256,c-=8);f[p+_-i]|=128*d}},function(e){var t={}.toString;e.exports=Array.isArray||function(e){return'[object Array]'==t.call(e)}},function(e,t,n){function r(e){return Array(e)}var o=n(0),t=e.exports=r(0);t.alloc=r,t.concat=o.concat,t.from=function(e){if(!o.isBuffer(e)&&o.isView(e))e=o.Uint8Array.from(e);else if(o.isArrayBuffer(e))e=new Uint8Array(e);else{if('string'==typeof e)return o.from.call(t,e);if('number'==typeof e)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(e)}},function(e,t,n){function r(e){return new a(e)}var o=n(0),a=o.global,t=e.exports=o.hasBuffer?r(0):[];t.alloc=o.hasBuffer&&a.alloc||r,t.concat=o.concat,t.from=function(e){if(!o.isBuffer(e)&&o.isView(e))e=o.Uint8Array.from(e);else if(o.isArrayBuffer(e))e=new Uint8Array(e);else{if('string'==typeof e)return o.from.call(t,e);if('number'==typeof e)throw new TypeError('"value" argument must not be a number')}return a.from&&1!==a.from.length?a.from(e):new a(e)}},function(e,t,n){function r(e){return new Uint8Array(e)}var o=n(0),t=e.exports=o.hasArrayBuffer?r(0):[];t.alloc=r,t.concat=o.concat,t.from=function(e){if(o.isView(e)){var n=e.byteOffset,r=e.byteLength;e=e.buffer,e.byteLength!==r&&(e.slice?e=e.slice(n,n+r):(e=new Uint8Array(e),e.byteLength!==r&&(e=Array.prototype.slice.call(e,n,n+r))))}else{if('string'==typeof e)return o.from.call(t,e);if('number'==typeof e)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(e)}},function(e,t){t.copy=function(e,t,n,r){var o;n||(n=0),r||0===r||(r=this.length),t||(t=0);var a=r-n;if(e===this&&n<t&&t<r)for(o=a-1;0<=o;o--)e[o+t]=this[o+n];else for(o=0;o<a;o++)e[o+t]=this[o+n];return a},t.toString=function(e,t,n){var r=this,o=0|t;n||(n=r.length);for(var a='',i=0;o<n;){if(i=r[o++],128>i){a+=s(i);continue}192==(224&i)?i=(31&i)<<6|63&r[o++]:224==(240&i)?i=(15&i)<<12|(63&r[o++])<<6|63&r[o++]:240==(248&i)&&(i=(7&i)<<18|(63&r[o++])<<12|(63&r[o++])<<6|63&r[o++]),65536<=i?(i-=65536,a+=s((i>>>10)+55296,(1023&i)+56320)):a+=s(i)}return a},t.write=function(e,t){for(var n=this,r=t||(t|=0),o=e.length,a=0,s=0;s<o;)a=e.charCodeAt(s++),128>a?n[r++]=a:2048>a?(n[r++]=192|a>>>6,n[r++]=128|63&a):55296>a||57343<a?(n[r++]=224|a>>>12,n[r++]=128|63&a>>>6,n[r++]=128|63&a):(a=(a-55296<<10|e.charCodeAt(s++)-56320)+65536,n[r++]=240|a>>>18,n[r++]=128|63&a>>>12,n[r++]=128|63&a>>>6,n[r++]=128|63&a);return r-t}},function(e,t,n){function r(e){return s||(s=n(11).encode),s(e)}function o(e){return e.valueOf()}function a(e){e=RegExp.prototype.toString.call(e).split('/'),e.shift();var t=[e.pop()];return t.unshift(e.join('/')),t}function i(e){var t={};for(var n in d)t[n]=e[n];return t}t.setExtPackers=function(e){e.addExtPacker(14,Error,[i,r]),e.addExtPacker(1,EvalError,[i,r]),e.addExtPacker(2,RangeError,[i,r]),e.addExtPacker(3,ReferenceError,[i,r]),e.addExtPacker(4,SyntaxError,[i,r]),e.addExtPacker(5,TypeError,[i,r]),e.addExtPacker(6,URIError,[i,r]),e.addExtPacker(10,RegExp,[a,r]),e.addExtPacker(11,Boolean,[o,r]),e.addExtPacker(12,String,[o,r]),e.addExtPacker(13,Date,[Number,r]),e.addExtPacker(15,Number,[o,r]),'undefined'!=typeof Uint8Array&&(e.addExtPacker(17,Int8Array,p),e.addExtPacker(18,Uint8Array,p),e.addExtPacker(19,Int16Array,p),e.addExtPacker(20,Uint16Array,p),e.addExtPacker(21,Int32Array,p),e.addExtPacker(22,Uint32Array,p),e.addExtPacker(23,Float32Array,p),'undefined'!=typeof Float64Array&&e.addExtPacker(24,Float64Array,p),'undefined'!=typeof Uint8ClampedArray&&e.addExtPacker(25,Uint8ClampedArray,p),e.addExtPacker(26,ArrayBuffer,p),e.addExtPacker(29,DataView,p)),f.hasBuffer&&e.addExtPacker(27,l,f.from)};var s,f=n(0),l=f.global,p=f.Uint8Array.from,d={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1}},function(e,t,n){var r=n(5),o=n(7),a=o.Uint64BE,i=o.Int64BE,s=n(0),f=n(6),l=n(39),p=n(15).uint8,d=n(4).ExtBuffer,c='undefined'!=typeof Uint8Array,u='undefined'!=typeof Map,y=[];y[1]=212,y[2]=213,y[4]=214,y[8]=215,y[16]=216,t.getWriteType=function(e){function t(e,t){B[207](e,t.toArray())}function n(e,t){B[211](e,t.toArray())}function o(e,o){if(null===o)return h(e,o);if(x(o))return S(e,o);if(r(o))return g(e,o);if(a.isUint64BE(o))return t(e,o);if(i.isInt64BE(o))return n(e,o);var s=e.codec.getExtPacker(o);return s&&(o=s(o)),o instanceof d?m(e,o):void R(e,o)}function h(e,t){B[192](e,t)}function g(e,t){var n=t.length,r=16>n?144+n:65535>=n?220:221;B[r](e,n);for(var o=e.codec.encode,a=0;a<n;a++)o(e,t[a])}function b(e,t){var n=t.length,r=255>n?196:65535>=n?197:198;B[r](e,n),e.send(t)}function m(e,t){var n=t.buffer,r=n.length,o=y[r]||(255>r?199:65535>=r?200:201);B[o](e,r),p[t.type](e),e.send(n)}function E(e,t){var n=Object.keys(t),r=n.length,o=16>r?128+r:65535>=r?222:223;B[o](e,r);var a=e.codec.encode;n.forEach(function(n){a(e,n),a(e,t[n])})}function A(e,t){var n=t.length,r=32>n?160+n:65535>=n?218:219;B[r](e,n),e.send(t)}var B=l.getWriteToken(e),_=e&&e.useraw,v=c&&e&&e.binarraybuffer,x=v?s.isArrayBuffer:s.isBuffer,S=v?function(e,t){b(e,new Uint8Array(t))}:b,P=u&&e&&e.usemap,R=P?function(e,t){if(!(t instanceof Map))return E(e,t);var n=t.size,r=16>n?128+n:65535>=n?222:223;B[r](e,n);var o=e.codec.encode;t.forEach(function(t,n){o(e,n),o(e,t)})}:E,T={boolean:function(e,t){var n=t?195:194;B[n](e,t)},function:h,number:function(e,t){var n,r=0|t;if(t!==r)return n=203,void B[n](e,t);n=-32<=r&&127>=r?255&r:0<=r?255>=r?204:65535>=r?205:206:-128<=r?208:-32768<=r?209:210;B[n](e,r)},object:_?function(e,t){return x(t)?A(e,t):void o(e,t)}:o,string:function(e){return function(t,n){var r=n.length,o=5+3*r;t.offset=t.reserve(o);var a=t.buffer,i=e(r),s=t.offset+i;r=f.write.call(a,n,s);var l=e(r);if(i!==l){var p=s+r;f.copy.call(a,a,s+l-i,s,p)}var d=1===l?160+r:3>=l?215+l:219;B[d](t,r),t.offset+=r}}(_?function(e){return 32>e?1:65535>=e?3:5}:function(e){return 32>e?1:255>=e?2:65535>=e?3:5}),symbol:h,undefined:h};return T}},function(e,t,n){function r(){var e=o();return e[202]=l(202,4,c),e[203]=l(203,8,u),e}function o(){var e=m.slice();return e[196]=i(196),e[197]=s(197),e[198]=f(198),e[199]=i(199),e[200]=s(200),e[201]=f(201),e[202]=l(202,4,v.writeFloatBE||c,!0),e[203]=l(203,8,v.writeDoubleBE||u,!0),e[204]=i(204),e[205]=s(205),e[206]=f(206),e[207]=l(207,8,p),e[208]=i(208),e[209]=s(209),e[210]=f(210),e[211]=l(211,8,d),e[217]=i(217),e[218]=s(218),e[219]=f(219),e[220]=s(220),e[221]=f(221),e[222]=s(222),e[223]=f(223),e}function a(){var e=m.slice();return e[196]=l(196,1,A.prototype.writeUInt8),e[197]=l(197,2,A.prototype.writeUInt16BE),e[198]=l(198,4,A.prototype.writeUInt32BE),e[199]=l(199,1,A.prototype.writeUInt8),e[200]=l(200,2,A.prototype.writeUInt16BE),e[201]=l(201,4,A.prototype.writeUInt32BE),e[202]=l(202,4,A.prototype.writeFloatBE),e[203]=l(203,8,A.prototype.writeDoubleBE),e[204]=l(204,1,A.prototype.writeUInt8),e[205]=l(205,2,A.prototype.writeUInt16BE),e[206]=l(206,4,A.prototype.writeUInt32BE),e[207]=l(207,8,p),e[208]=l(208,1,A.prototype.writeInt8),e[209]=l(209,2,A.prototype.writeInt16BE),e[210]=l(210,4,A.prototype.writeInt32BE),e[211]=l(211,8,d),e[217]=l(217,1,A.prototype.writeUInt8),e[218]=l(218,2,A.prototype.writeUInt16BE),e[219]=l(219,4,A.prototype.writeUInt32BE),e[220]=l(220,2,A.prototype.writeUInt16BE),e[221]=l(221,4,A.prototype.writeUInt32BE),e[222]=l(222,2,A.prototype.writeUInt16BE),e[223]=l(223,4,A.prototype.writeUInt32BE),e}function i(e){return function(t,n){var r=t.reserve(2),o=t.buffer;o[r++]=e,o[r]=n}}function s(e){return function(t,n){var r=t.reserve(3),o=t.buffer;o[r++]=e,o[r++]=n>>>8,o[r]=n}}function f(e){return function(t,n){var r=t.reserve(5),o=t.buffer;o[r++]=e,o[r++]=n>>>24,o[r++]=n>>>16,o[r++]=n>>>8,o[r]=n}}function l(e,t,n,r){return function(o,a){var i=o.reserve(t+1);o.buffer[i++]=e,n.call(o.buffer,a,i,r)}}function p(e,t){new g(this,t,e)}function d(e,t){new b(this,t,e)}function c(e,t){y.write(this,e,t,!1,23,4)}function u(e,t){y.write(this,e,t,!1,52,8)}var y=n(14),h=n(7),g=h.Uint64BE,b=h.Int64BE,m=n(15).uint8,E=n(0),A=E.global,B=E.hasBuffer&&'TYPED_ARRAY_SUPPORT'in A,_=B&&!A.TYPED_ARRAY_SUPPORT,v=E.hasBuffer&&A.prototype||{};t.getWriteToken=function(e){return e&&e.uint8array?r():_||E.hasBuffer&&e&&e.safe?a():o()}},function(e,t,n){function r(e){return f||(f=n(17).decode),f(e)}function o(e){return RegExp.apply(null,e)}function a(e){return function(t){var n=new e;for(var r in d)n[r]=t[r];return n}}function i(e){return function(t){return new e(t)}}function s(e){return new Uint8Array(e).buffer}t.setExtUnpackers=function(e){e.addExtUnpacker(14,[r,a(Error)]),e.addExtUnpacker(1,[r,a(EvalError)]),e.addExtUnpacker(2,[r,a(RangeError)]),e.addExtUnpacker(3,[r,a(ReferenceError)]),e.addExtUnpacker(4,[r,a(SyntaxError)]),e.addExtUnpacker(5,[r,a(TypeError)]),e.addExtUnpacker(6,[r,a(URIError)]),e.addExtUnpacker(10,[r,o]),e.addExtUnpacker(11,[r,i(Boolean)]),e.addExtUnpacker(12,[r,i(String)]),e.addExtUnpacker(13,[r,i(Date)]),e.addExtUnpacker(15,[r,i(Number)]),'undefined'!=typeof Uint8Array&&(e.addExtUnpacker(17,i(Int8Array)),e.addExtUnpacker(18,i(Uint8Array)),e.addExtUnpacker(19,[s,i(Int16Array)]),e.addExtUnpacker(20,[s,i(Uint16Array)]),e.addExtUnpacker(21,[s,i(Int32Array)]),e.addExtUnpacker(22,[s,i(Uint32Array)]),e.addExtUnpacker(23,[s,i(Float32Array)]),'undefined'!=typeof Float64Array&&e.addExtUnpacker(24,[s,i(Float64Array)]),'undefined'!=typeof Uint8ClampedArray&&e.addExtUnpacker(25,i(Uint8ClampedArray)),e.addExtUnpacker(26,s),e.addExtUnpacker(29,[s,i(DataView)])),l.hasBuffer&&e.addExtUnpacker(27,i(p))};var f,l=n(0),p=l.global,d={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1}},function(e,t,n){function r(e){var t,n=Array(256);for(t=0;127>=t;t++)n[t]=a(t);for(t=128;143>=t;t++)n[t]=f(t-128,e.map);for(t=144;159>=t;t++)n[t]=f(t-144,e.array);for(t=160;191>=t;t++)n[t]=f(t-160,e.str);for(n[192]=a(null),n[193]=null,n[194]=a(!1),n[195]=a(!0),n[196]=s(e.uint8,e.bin),n[197]=s(e.uint16,e.bin),n[198]=s(e.uint32,e.bin),n[199]=s(e.uint8,e.ext),n[200]=s(e.uint16,e.ext),n[201]=s(e.uint32,e.ext),n[202]=e.float32,n[203]=e.float64,n[204]=e.uint8,n[205]=e.uint16,n[206]=e.uint32,n[207]=e.uint64,n[208]=e.int8,n[209]=e.int16,n[210]=e.int32,n[211]=e.int64,n[212]=f(1,e.ext),n[213]=f(2,e.ext),n[214]=f(4,e.ext),n[215]=f(8,e.ext),n[216]=f(16,e.ext),n[217]=s(e.uint8,e.str),n[218]=s(e.uint16,e.str),n[219]=s(e.uint32,e.str),n[220]=s(e.uint16,e.array),n[221]=s(e.uint32,e.array),n[222]=s(e.uint16,e.map),n[223]=s(e.uint32,e.map),t=224;255>=t;t++)n[t]=a(t-256);return n}function o(e){var t,n=r(e).slice();for(n[217]=n[196],n[218]=n[197],n[219]=n[198],t=160;191>=t;t++)n[t]=f(t-160,e.bin);return n}function a(e){return function(){return e}}function s(e,t){return function(n){var r=e(n);return t(n,r)}}function f(e,t){return function(n){return t(n,e)}}var i=n(19);t.getReadToken=function(e){var t=i.getReadFormat(e);return e&&e.useraw?o(t):r(t)}},function(e,t,n){function r(e){return this instanceof r?void a.call(this,e):new r(e)}t.Encoder=r;var o=n(20),a=n(12).EncodeBuffer;r.prototype=new a,o.mixin(r.prototype),r.prototype.encode=function(e){this.write(e),this.emit('data',this.read())},r.prototype.end=function(e){arguments.length&&this.encode(e),this.flush(),this.emit('end')}},function(e,t,n){function r(e){return this instanceof r?void a.call(this,e):new r(e)}t.Decoder=r;var o=n(20),a=n(18).DecodeBuffer;r.prototype=new a,o.mixin(r.prototype),r.prototype.decode=function(e){arguments.length&&this.write(e),this.flush()},r.prototype.push=function(e){this.emit('data',e)},r.prototype.end=function(e){this.decode(e),this.emit('end')}},function(e,t,n){n(8),n(3),t.createCodec=n(1).createCodec},function(e,t,n){n(8),n(3),t.codec={preset:n(1).preset}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n;(function(e){e.ListDir='fs:list_dir',e.CreateDir='fs:create_dir',e.GetDrives='fs:drives',e.CreateDrive='fs:create_drive',e.AttachDrive='fs:attach_drive',e.DetachDrive='fs:detach_drive',e.GiveFile='fs:give_file',e.GetFile='fs:get_file',e.DeletePath='fs:delete_path',e.AllowAccess='fw:allow_access',e.GetHostCertificate='fw:host_certificate',e.RegisterUser='um:register',e.GrantUserPerms='um:add_perms',e.RetractUserPerms='um:retract_perms',e.GetExistingTerminals='term:existing',e.StartTerminal='term:start',e.ResizeTerminal='term:resize',e.TerminalInput='term:input',e.RestartVM='vm:restart'})(n=t.RequestType||(t.RequestType={}))}])});